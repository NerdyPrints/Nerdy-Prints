<!-- Same Page Layout as Before â€“ Only Updated the Form Section -->
<!-- Username Field Added and Validation Check for Uniqueness -->
<!-- Update the scriptURL in this file -->

<form id="signupForm">
  <label for="username">Username</label>
  <input type="text" id="username" name="username" required>
  <button type="button" id="checkUsernameButton">Check Availability</button>
  <p id="usernameStatus"></p>

  <!-- Existing fields like Name, Email, etc -->
  <label for="name">Name</label>
  <input type="text" id="name" name="name" required>

  <label for="email">Email Address</label>
  <input type="email" id="email" name="email" required>

  <label for="address">Address</label>
  <input type="text" id="address" name="address" required>

  <label for="age">Age</label>
  <input type="number" id="age" name="age" required>

  <label for="gender">Gender</label>
  <select id="gender" name="gender" required>
    <option value="Male">Male</option>
    <option value="Female">Female</option>
    <option value="Other">Other</option>
  </select>

  <label for="password">Password</label>
  <input type="password" id="password" name="password" required>

  <button type="submit">Sign Up - KABOOM!</button>
</form>

<script>
const signupForm = document.getElementById('signupForm');
const usernameInput = document.getElementById('username');
const usernameStatus = document.getElementById('usernameStatus');
const checkUsernameButton = document.getElementById('checkUsernameButton');

const scriptURL = 'YOUR_DEPLOYED_SCRIPT_URL';

checkUsernameButton.addEventListener('click', () => {
  const username = usernameInput.value.trim();
  if (!username) return;

  fetch(`${scriptURL}?checkUsername=${username}`)
    .then(res => res.text())
    .then(status => {
      if (status === 'taken') {
        usernameStatus.textContent = 'Username already taken. Choose another.';
        usernameStatus.style.color = 'red';
      } else {
        usernameStatus.textContent = 'Username available!';
        usernameStatus.style.color = 'green';
      }
    })
    .catch(err => console.error('Username check failed', err));
});

signupForm.addEventListener('submit', e => {
  e.preventDefault();

  const formData = new FormData(signupForm);
  fetch(scriptURL, { method: 'POST', body: formData })
    .then(res => res.text())
    .then(text => {
      if (text.trim() === 'Success') {
        alert('Sign-up successful!');
        window.location.href = '/login/';
      } else if (text.trim() === 'UsernameTaken') {
        alert('Username is already taken. Choose another.');
      } else {
        alert('Sign-up failed. Please try again.');
      }
    })
    .catch(err => {
      console.error('Sign-up failed', err);
      alert('An error occurred. Please try again.');
    });
});
</script>
